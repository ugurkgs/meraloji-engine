<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MERALOJÄ° | F.I.S.H. System</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;900&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
    
    <!-- Leaflet Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           DESIGN SYSTEM - CSS Variables
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        :root {
            --bg-deep: #040d1a;
            --bg-panel: rgba(8, 24, 48, 0.95);
            --bg-card: rgba(15, 35, 65, 0.8);
            
            --cyan: #00d4ff;
            --cyan-glow: rgba(0, 212, 255, 0.3);
            --green: #00ff88;
            --green-glow: rgba(0, 255, 136, 0.2);
            --yellow: #ffd500;
            --red: #ff4757;
            --orange: #ff9f43;
            
            --text-primary: #ffffff;
            --text-secondary: #8ba4c7;
            --text-muted: #5a7193;
            
            --border-subtle: rgba(0, 212, 255, 0.15);
            --border-glow: rgba(0, 212, 255, 0.4);
            
            --font-display: 'Outfit', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
            --radius-xl: 28px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           BASE STYLES
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: var(--font-display);
            background: var(--bg-deep);
            color: var(--text-primary);
            min-height: 100vh;
            overflow: hidden;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           SPLASH SCREEN
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #splash {
            position: fixed;
            inset: 0;
            background: linear-gradient(180deg, #020c1a 0%, #0a1628 50%, #071020 100%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s ease, visibility 0.8s;
        }

        #splash.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .splash-logo {
            width: 250px;
            height: 250px;
            filter: drop-shadow(0 0 60px var(--cyan-glow));
            animation: float 3s ease-in-out infinite;
            margin-bottom: 24px;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .splash-title {
            font-size: 2.5rem;
            font-weight: 900;
            letter-spacing: 6px;
            background: linear-gradient(135deg, var(--cyan) 0%, #00ff88 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .splash-subtitle {
            font-family: var(--font-mono);
            font-size: 1.1rem;
            color: var(--cyan);
            letter-spacing: 8px;
            opacity: 0.9;
        }

        .splash-tagline {
            font-size: 0.85rem;
            color: var(--text-muted);
            letter-spacing: 2px;
            margin-top: 8px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MAP
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #map {
            position: fixed;
            inset: 0;
            z-index: 1;
            cursor: crosshair;
            background: var(--bg-deep);
        }

        /* Custom Marker */
        .radar-marker {
            width: 28px;
            height: 28px;
            background: var(--cyan);
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 20px var(--cyan), 0 0 40px var(--cyan-glow);
            position: relative;
        }

        .radar-marker::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            border: 2px solid var(--cyan);
            border-radius: 50%;
            animation: radar-pulse 2s infinite;
            pointer-events: none;
        }

        @keyframes radar-pulse {
            0% { width: 28px; height: 28px; opacity: 0.8; }
            100% { width: 120px; height: 120px; opacity: 0; }
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           TOP CONTROLS
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #controls {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 40px);
            max-width: 500px;
            z-index: 1000;
            display: flex;
            gap: 12px;
            opacity: 0;
            transition: opacity 0.5s ease 0.3s;
        }

        #controls.visible { opacity: 1; }

        /* Map Welcome Overlay */
        .map-welcome {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 500;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }
        
        .map-welcome.hidden {
            opacity: 0;
        }
        
        .welcome-content {
            background: rgba(13, 17, 23, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 16px 24px;
            text-align: center;
        }
        
        .welcome-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        
        .welcome-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--cyan);
            letter-spacing: 1px;
            margin-bottom: 4px;
        }
        
        .welcome-subtitle {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .btn-icon {
            width: 52px;
            height: 52px;
            background: var(--bg-panel);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 1.3rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(20px);
            transition: all 0.2s;
        }

        .btn-icon:hover {
            border-color: var(--cyan);
            box-shadow: 0 0 20px var(--cyan-glow);
        }

        .btn-icon.active {
            background: var(--cyan);
            color: var(--bg-deep);
        }

        .search-wrapper {
            flex: 1;
            position: relative;
        }

        .search-box {
            width: 100%;
            height: 52px;
            background: var(--bg-panel);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            padding: 0 16px;
            gap: 12px;
            backdrop-filter: blur(20px);
        }

        .search-box input {
            flex: 1;
            background: none;
            border: none;
            color: var(--text-primary);
            font-family: var(--font-display);
            font-size: 1rem;
            outline: none;
        }

        .search-box input::placeholder {
            color: var(--text-muted);
        }

        /* Autocomplete Dropdown */
        .search-suggestions {
            position: absolute;
            top: 58px;
            left: 0;
            right: 0;
            background: var(--bg-panel);
            border: 1px solid var(--border-glow);
            border-radius: var(--radius-md);
            max-height: 300px;
            overflow-y: auto;
            display: none;
            backdrop-filter: blur(20px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .search-suggestions.active {
            display: block;
        }

        .suggestion-item {
            padding: 14px 16px;
            cursor: pointer;
            border-bottom: 1px solid var(--border-subtle);
            transition: background 0.2s;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-item:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .suggestion-item .name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .suggestion-item .region {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           LOADING OVERLAY
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #loading {
            position: fixed;
            inset: 0;
            background: rgba(4, 13, 26, 0.95);
            z-index: 2000;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }

        .radar-spinner {
            width: 80px;
            height: 80px;
            border: 3px solid var(--border-subtle);
            border-top-color: var(--cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 24px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        #log-output {
            font-family: var(--font-mono);
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-align: left;
            max-width: 320px;
        }

        .log-line {
            margin-bottom: 8px;
            opacity: 0;
            animation: fadeIn 0.3s forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .log-line span {
            color: var(--yellow);
            font-weight: 700;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           HUD PANEL
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #hud {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-height: 85vh;
            background: var(--bg-panel);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            border-top: 1px solid var(--border-glow);
            z-index: 1500;
            display: none;
            flex-direction: column;
            backdrop-filter: blur(30px);
            box-shadow: 0 -20px 60px rgba(0, 0, 0, 0.5);
        }

        @media (min-width: 768px) {
            #hud {
                bottom: 20px;
                right: 20px;
                left: auto;
                width: 420px;
                max-height: 80vh;
                border-radius: var(--radius-lg);
                border: 1px solid var(--border-glow);
            }
        }

        .hud-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .hud-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .hud-close {
            width: 36px;
            height: 36px;
            background: transparent;
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .hud-close:hover {
            border-color: var(--red);
            color: var(--red);
        }

        .hud-content {
            padding: 20px 24px;
            overflow-y: auto;
            flex: 1;
        }

        /* Score Box */
        .score-box {
            text-align: center;
            padding: 24px;
            background: linear-gradient(180deg, var(--bg-card) 0%, transparent 100%);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-subtle);
            margin-bottom: 20px;
        }

        .mode-tabs {
            display: inline-flex;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 4px;
            margin-bottom: 16px;
        }

        .mode-tab {
            padding: 8px 20px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-family: var(--font-display);
            font-size: 0.8rem;
            font-weight: 700;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .mode-tab.active {
            background: var(--cyan);
            color: var(--bg-deep);
            box-shadow: 0 0 20px var(--cyan-glow);
        }

        .main-score {
            font-size: 4.5rem;
            font-weight: 900;
            line-height: 1;
            margin: 8px 0;
        }

        .main-score sup {
            font-size: 1.5rem;
            opacity: 0.6;
            vertical-align: super;
        }

        .weather-label {
            font-family: var(--font-mono);
            font-size: 0.95rem;
            color: var(--cyan);
            letter-spacing: 1px;
            font-weight: 700;
        }

        .confidence-badge {
            display: inline-block;
            margin-top: 12px;
            padding: 6px 14px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Tactic Box */
        /* Activity Windows Card */
        .activity-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
            overflow: hidden;
        }
        
        .activity-row {
            display: flex;
            align-items: center;
            padding: 12px 14px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid var(--border-subtle);
        }
        
        .activity-row:last-child {
            border-bottom: none;
        }
        
        .activity-row:hover {
            background: rgba(0, 212, 255, 0.1);
        }
        
        .activity-icon {
            font-size: 1.2rem;
            margin-right: 12px;
        }
        
        .activity-label {
            flex: 1;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
            letter-spacing: 0.5px;
        }
        
        .activity-time {
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--cyan);
            font-weight: 500;
        }
        
        /* Activity Tooltip */
        .activity-tooltip {
            position: fixed;
            background: var(--bg-panel);
            border: 1px solid var(--cyan);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            font-size: 0.85rem;
            color: var(--text-primary);
            max-width: 280px;
            z-index: 9999;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            animation: tooltipFade 0.2s ease;
        }
        
        .activity-tooltip::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid var(--cyan);
        }
        
        @keyframes tooltipFade {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tactic-box {
            background: linear-gradient(90deg, var(--cyan-glow) 0%, transparent 100%);
            border-left: 3px solid var(--cyan);
            padding: 16px;
            border-radius: 0 var(--radius-md) var(--radius-md) 0;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: var(--text-primary);
            line-height: 1.5;
        }

        .tactic-box::before {
            content: 'ğŸ’¡';
            margin-right: 10px;
        }

        /* Metrics Grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 24px;
        }

        @media (max-width: 480px) {
            .metrics-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .metric-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-sm);
            padding: 10px 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .metric-card:hover {
            border-color: var(--cyan);
            transform: translateY(-2px);
        }

        .metric-icon {
            font-size: 1.2rem;
            margin-bottom: 4px;
        }

        .metric-val {
            font-weight: 800;
            font-size: 0.9rem;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .metric-label {
            font-size: 0.55rem;
            color: var(--text-muted);
            margin-top: 2px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        /* Fish List */
        .section-title {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 700;
            letter-spacing: 1px;
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .fish-item {
            background: linear-gradient(90deg, var(--bg-card) 0%, transparent 100%);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--text-muted);
            padding: 14px 16px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .fish-item:hover {
            transform: translateX(4px);
        }

        .fish-item.score-high { border-left-color: var(--green); }
        .fish-item.score-mid { border-left-color: var(--yellow); }
        .fish-item.score-low { border-left-color: var(--red); }

        .fish-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .fish-name {
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .fish-score {
            font-weight: 900;
            font-size: 1.1rem;
        }

        .fish-details {
            display: none;
            margin-top: 14px;
            padding-top: 14px;
            border-top: 1px solid var(--border-subtle);
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .fish-item.open .fish-details {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fish-reason {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .fish-reason.positive {
            background: var(--green-glow);
            color: var(--green);
        }

        .fish-reason.negative {
            background: rgba(255, 71, 87, 0.2);
            color: var(--red);
        }

        .fish-tip {
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--radius-sm);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Action Buttons */
        .btn-primary {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--cyan) 0%, #0099cc 100%);
            border: none;
            border-radius: var(--radius-md);
            color: var(--bg-deep);
            font-family: var(--font-display);
            font-weight: 800;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 16px;
            box-shadow: 0 8px 30px var(--cyan-glow);
            transition: all 0.2s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px var(--cyan-glow);
        }

        .btn-secondary {
            flex: 1;
            padding: 14px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-secondary:hover {
            border-color: var(--cyan);
        }

        .btn-row {
            display: flex;
            gap: 12px;
            margin-top: 12px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           SIDE MENU
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #menu-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            z-index: 2999;
            display: none;
        }

        #side-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            height: 100%;
            background: var(--bg-panel);
            border-right: 1px solid var(--border-subtle);
            z-index: 3000;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            padding: 24px;
            display: flex;
            flex-direction: column;
        }

        #side-menu.active {
            transform: translateX(0);
        }

        .menu-header {
            font-size: 1.3rem;
            font-weight: 900;
            color: var(--cyan);
            letter-spacing: 2px;
            margin-bottom: 32px;
        }

        .menu-section {
            margin-bottom: 24px;
        }

        .menu-section h3 {
            font-size: 0.75rem;
            color: var(--text-muted);
            letter-spacing: 1px;
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .menu-btn {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 0.9rem;
            text-align: left;
            cursor: pointer;
            margin-bottom: 8px;
            transition: all 0.2s;
        }

        .menu-btn:hover {
            border-color: var(--cyan);
            background: rgba(0, 212, 255, 0.1);
        }

        .map-layer-indicator {
            font-size: 0.7rem;
            color: var(--cyan);
            margin-left: 8px;
        }

        .menu-footer {
            margin-top: auto;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MODALS
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .modal {
            position: fixed;
            inset: 0;
            background: var(--bg-deep);
            z-index: 4000;
            display: none;
            flex-direction: column;
            padding: 20px;
            overflow-y: auto;
        }

        .modal-back {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: var(--font-display);
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 24px;
            transition: all 0.2s;
        }

        .modal-back:hover {
            border-color: var(--cyan);
        }

        .modal-title {
            text-align: center;
            font-size: 1.3rem;
            font-weight: 900;
            color: var(--cyan);
            letter-spacing: 1px;
            margin-bottom: 24px;
        }

        /* Weekly Modal */
        .day-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .day-row:hover {
            border-color: var(--cyan);
            transform: translateX(4px);
        }

        .day-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .day-date {
            font-weight: 700;
        }

        .day-weather {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .day-score {
            font-weight: 900;
            font-size: 1.2rem;
            padding: 6px 14px;
            border-radius: var(--radius-sm);
            background: rgba(255, 255, 255, 0.1);
        }

        /* Metric Info Modal */
        #metric-modal {
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.85);
        }

        .metric-modal-content {
            background: var(--bg-panel);
            border: 1px solid var(--cyan);
            border-radius: var(--radius-lg);
            padding: 28px;
            width: 90%;
            max-width: 450px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .metric-modal-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .metric-modal-icon {
            font-size: 3.5rem;
            margin-bottom: 12px;
        }

        .metric-modal-title {
            font-size: 1.3rem;
            font-weight: 900;
            color: var(--cyan);
            letter-spacing: 1px;
        }

        .metric-info-section {
            margin-bottom: 16px;
        }

        .metric-info-label {
            font-size: 0.7rem;
            color: var(--cyan);
            font-weight: 700;
            letter-spacing: 1px;
            margin-bottom: 8px;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .metric-info-content {
            background: var(--bg-card);
            padding: 14px;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            color: var(--text-primary);
            line-height: 1.6;
            border-left: 3px solid var(--border-subtle);
        }

        .metric-info-content.highlight {
            border-left-color: var(--cyan);
            background: rgba(0, 212, 255, 0.05);
        }

        .metric-info-content.algo {
            border-left-color: var(--green);
            background: rgba(0, 255, 136, 0.05);
            font-family: var(--font-mono);
            font-size: 0.85rem;
        }

        .metric-range-bar {
            height: 8px;
            background: linear-gradient(90deg, var(--red) 0%, var(--yellow) 50%, var(--green) 100%);
            border-radius: 4px;
            margin: 12px 0;
        }

        /* Tech Modal - Algorithm Details */
        .algo-section {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid var(--cyan);
        }

        .algo-section.fuzzy { border-left-color: var(--cyan); }
        .algo-section.gaussian { border-left-color: var(--green); }
        .algo-section.solunar { border-left-color: var(--yellow); }
        .algo-section.local { border-left-color: var(--orange); }

        .algo-title {
            font-size: 1.1rem;
            font-weight: 800;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .algo-title .icon {
            font-size: 1.4rem;
        }

        .algo-description {
            color: var(--text-secondary);
            line-height: 1.7;
            font-size: 0.9rem;
            margin-bottom: 16px;
        }

        .algo-formula {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--cyan);
            margin-bottom: 16px;
            overflow-x: auto;
        }

        .algo-example {
            background: rgba(0, 212, 255, 0.1);
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .algo-example strong {
            color: var(--yellow);
        }

        .algo-reference {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-sm);
            border: 1px dashed var(--border-subtle);
        }

        .algo-reference .ref-icon {
            font-size: 1.2rem;
        }

        .algo-reference .ref-content {
            flex: 1;
        }

        .algo-reference .ref-title {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 0.85rem;
        }

        .algo-reference .ref-author {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           UTILITIES
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .color-green { color: var(--green); }
        .color-yellow { color: var(--yellow); }
        .color-red { color: var(--red); }
        .color-cyan { color: var(--cyan); }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-subtle);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--cyan);
        }
    </style>
</head>
<body>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         SPLASH SCREEN
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="splash">
        <img src="logo.png" alt="Meraloji" class="splash-logo" onerror="this.style.display='none'">
        <div class="splash-title">MERALOJÄ°</div>
        <div class="splash-subtitle">F.I.S.H.</div>
        <div class="splash-tagline">Find â€¢ Inspect â€¢ See â€¢ Hunt</div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MAP
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="map"></div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         TOP CONTROLS
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="controls">
        <button class="btn-icon" onclick="toggleMenu()">â˜°</button>
        <button id="lang-btn" onclick="toggleLanguage()" style="background: rgba(0,212,255,0.2); border: 1px solid var(--cyan); color: var(--cyan); padding: 6px 12px; border-radius: 8px; font-size: 0.8rem; font-weight: 700; cursor: pointer; margin-left: -8px;">TR</button>
        <div class="search-wrapper">
            <div class="search-box">
                <span style="color: var(--text-muted);">ğŸ”</span>
                <input type="text" id="search-input" placeholder="Mera ara..." autocomplete="off">
            </div>
            <div class="search-suggestions" id="search-suggestions"></div>
        </div>
        <button class="btn-icon" style="color: var(--cyan);" onclick="locateMe()">ğŸ¯</button>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MAP WELCOME OVERLAY - Ä°lk kullanÄ±cÄ± yÃ¶nlendirmesi
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="map-welcome" class="map-welcome">
        <div class="welcome-content">
            <div class="welcome-icon">ğŸ£</div>
            <div class="welcome-title" id="welcome-title">BALIK MERA ANALÄ°ZÄ°</div>
            <div class="welcome-subtitle" id="welcome-subtitle">+ Denizde bir noktaya tÄ±klayÄ±n</div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         LOADING OVERLAY
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="loading">
        <div class="radar-spinner"></div>
        <div id="log-output"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         HUD PANEL
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="hud">
        <div class="hud-header">
            <span class="hud-title" id="region-title">--</span>
            <button class="hud-close" onclick="closeHud()">âœ•</button>
        </div>
        <div class="hud-content">
            <div class="score-box">
                <div class="mode-tabs">
                    <button class="mode-tab active" id="tab-daily" onclick="setMode('daily')">GÃœN</button>
                    <button class="mode-tab" id="tab-instant" onclick="setMode('instant')">ANLIK</button>
                </div>
                <div class="main-score" id="score-display">--</div>
                <div class="weather-label" id="weather-display">--</div>
                <div class="confidence-badge" id="confidence-display">GÃ¼ven: --%</div>
            </div>

            <!-- Aktivite Saatleri KartÄ± -->
            <div id="activity-windows" class="activity-card" style="display: none;">
                <div class="activity-row" onclick="showActivityTip('morning')">
                    <span class="activity-icon">ğŸŒ…</span>
                    <span class="activity-label" id="activity-morning-label">SABAH SUYU</span>
                    <span class="activity-time" id="activity-morning-time">--:-- - --:--</span>
                </div>
                <div class="activity-row" onclick="showActivityTip('evening')">
                    <span class="activity-icon">ğŸŒ†</span>
                    <span class="activity-label" id="activity-evening-label">AKÅAM SUYU</span>
                    <span class="activity-time" id="activity-evening-time">--:-- - --:--</span>
                </div>
                <div class="activity-row" onclick="showActivityTip('night')">
                    <span class="activity-icon">ğŸŒ™</span>
                    <span class="activity-label" id="activity-night-label">GECE AVI</span>
                    <span class="activity-time" id="activity-night-time">22:00 - 03:00</span>
                </div>
            </div>

            <div class="tactic-box" id="tactic-display">Analiz bekleniyor...</div>

            <div class="metrics-grid" id="metrics-grid"></div>

            <div class="section-title" id="species-title">TÃ¼rler (Detay iÃ§in tÄ±klayÄ±n)</div>
            <div id="fish-list"></div>

            <button class="btn-primary" onclick="showWeeklyModal()">ğŸ“… 7 GÃ¼nlÃ¼k Tahmin Raporu</button>
            
            <button class="btn-secondary" style="width: 100%; margin-top: 12px;" onclick="saveFavorite()">â­ Favorilere Kaydet</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         SIDE MENU
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="menu-overlay" onclick="toggleMenu()"></div>
    <div id="side-menu">
        <div class="menu-header">MERALOJÄ°</div>
        
        <div class="menu-section">
            <h3>Favori MeralarÄ±m</h3>
            <div id="fav-list"></div>
        </div>

        <div class="menu-section">
            <h3>MenÃ¼</h3>
            <button class="menu-btn" onclick="changeMapLayer()">
                ğŸ—ºï¸ Harita KatmanÄ±
                <span class="map-layer-indicator" id="map-layer-name">(CoÄŸrafi)</span>
            </button>
            <button class="menu-btn" onclick="showTechModal()">ğŸ§  Algoritma DetayÄ±</button>
        </div>

        <div class="menu-footer">
            GeliÅŸtirici: UÄŸur KÃ¶gÃ¼s<br>
            F.I.S.H. System v1.0
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         WEEKLY MODAL
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="modal" id="weekly-modal">
        <button class="modal-back" onclick="closeModal('weekly-modal')">â† Geri DÃ¶n</button>
        <div class="modal-title">7 GÃœNLÃœK TAHMÄ°N</div>
        <div id="weekly-content"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         DAY DETAIL MODAL
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="modal" id="day-modal">
        <button class="modal-back" onclick="closeModal('day-modal')">â† Listeye DÃ¶n</button>
        <div style="text-align: center; margin-bottom: 20px;">
            <div style="font-size: 1.3rem; font-weight: 700;" id="dd-date">--</div>
            <div class="main-score" id="dd-score" style="font-size: 3.5rem;">--</div>
            <div class="weather-label" id="dd-weather">--</div>
        </div>
        <div class="tactic-box" id="dd-tactic">--</div>
        <div class="section-title">TÃ¼rler</div>
        <div id="dd-fish-list"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         METRIC INFO MODAL - DETAYLI
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="modal" id="metric-modal">
        <div class="metric-modal-content">
            <div class="metric-modal-header">
                <div class="metric-modal-icon" id="metric-icon">ğŸŒ¡ï¸</div>
                <div class="metric-modal-title" id="metric-title">--</div>
            </div>
            
            <div class="metric-info-section">
                <div class="metric-info-label">ğŸ“– TanÄ±m</div>
                <div class="metric-info-content" id="metric-desc">--</div>
            </div>

            <div class="metric-info-section">
                <div class="metric-info-label">ğŸ¯ BalÄ±kÃ§Ä±lÄ±kta Ã–nemi</div>
                <div class="metric-info-content highlight" id="metric-importance">--</div>
            </div>

            <div class="metric-info-section">
                <div class="metric-info-label">ğŸ“Š Referans AralÄ±ÄŸÄ±</div>
                <div class="metric-info-content" id="metric-ref">--</div>
                <div class="metric-range-bar"></div>
            </div>

            <div class="metric-info-section">
                <div class="metric-info-label">âš™ï¸ Algoritma Etkisi</div>
                <div class="metric-info-content algo" id="metric-algo">--</div>
            </div>

            <div class="metric-info-section">
                <div class="metric-info-label">ğŸ“š Bilimsel Kaynak</div>
                <div class="metric-info-content" id="metric-source">--</div>
            </div>

            <button class="btn-primary" onclick="closeModal('metric-modal')">KAPAT</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         TECH MODAL - ALGORÄ°TMA DETAYLARI
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="modal" id="tech-modal">
        <button class="modal-back" onclick="closeModal('tech-modal')">â† Kapat</button>
        <div class="modal-title">F.I.S.H. ALGORÄ°TMASI</div>
        
        <!-- 1. BULANIK MANTIK -->
        <div class="algo-section fuzzy">
            <div class="algo-title">
                <span class="icon">ğŸ”®</span>
                <span style="color: var(--cyan);">1. BULANIK MANTIK (Fuzzy Logic)</span>
            </div>
            <div class="algo-description">
                DoÄŸada hiÃ§bir ÅŸey "Siyah" ya da "Beyaz" deÄŸildir. Geleneksel sistemler "Su sÄ±caklÄ±ÄŸÄ± 18Â°C altÄ±ndaysa balÄ±k yok" der. 
                Ancak gerÃ§ekte 17.5Â°C ile 18.5Â°C arasÄ±nda keskin bir fark yoktur. BulanÄ±k MantÄ±k, bu belirsizliÄŸi modelleyerek 
                her deÄŸeri 0.0 ile 1.0 arasÄ±nda bir "Ã¼yelik derecesi"ne dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r.
            </div>
            <div class="algo-formula">
                Î¼(x) = { 0.2 + 0.8 Ã— (x - min) / (opt_min - min) } â†’ Trapezoid Fonksiyon
            </div>
            <div class="algo-example">
                <strong>Ã–rnek:</strong> RÃ¼zgar 20 km/s ve yÃ¶nÃ¼ Lodos (GÃ¼ney) ise sistem buna 0.85 puan verir. 
                AynÄ± hÄ±zda Poyraz (Kuzey) eserse puan 0.40'a dÃ¼ÅŸer. Ã‡Ã¼nkÃ¼ Marmara'da Lodos balÄ±ÄŸÄ± kÄ±yÄ±latÄ±rken, 
                Poyraz suyu soÄŸutup balÄ±ÄŸÄ± kaÃ§Ä±rÄ±r.
            </div>
            <div class="algo-reference">
                <span class="ref-icon">ğŸ“„</span>
                <div class="ref-content">
                    <div class="ref-title">"Fuzzy Logic Applications in Fisheries Management"</div>
                    <div class="ref-author">Zadeh, L.A. (1965) - Information and Control, Vol. 8</div>
                </div>
            </div>
        </div>

        <!-- 2. GAUSSIAN Ã‡AN EÄRÄ°SÄ° -->
        <div class="algo-section gaussian">
            <div class="algo-title">
                <span class="icon">ğŸ“Š</span>
                <span style="color: var(--green);">2. GAUSSIAN Ã‡AN EÄRÄ°SÄ° (Normal DaÄŸÄ±lÄ±m)</span>
            </div>
            <div class="algo-description">
                BalÄ±klar soÄŸukkanlÄ± (poikilotherm) canlÄ±lardÄ±r ve vÃ¼cut Ä±sÄ±larÄ±nÄ± dÃ¼zenleyemezler. Her tÃ¼rÃ¼n metabolizmasÄ±nÄ±n 
                en hÄ±zlÄ± Ã§alÄ±ÅŸtÄ±ÄŸÄ± bir "Optimal SÄ±caklÄ±k AralÄ±ÄŸÄ±" (T_opt) vardÄ±r. AnlÄ±k deniz suyu sÄ±caklÄ±ÄŸÄ± bu optimal deÄŸerden 
                ne kadar saparsa, balÄ±ÄŸÄ±n aktivitesi o kadar dÃ¼ÅŸer. Bu iliÅŸki Gaussian (Ã‡an) EÄŸrisi ile modellenir.
            </div>
            <div class="algo-formula">
                f(T) = exp( -(T - T_opt)Â² / (2ÏƒÂ²) ) â†’ Ïƒ = Tolerans geniÅŸliÄŸi
            </div>
            <div class="algo-example">
                <strong>Ã–rnek:</strong> Levrek iÃ§in T_opt = 15Â°C ve Ïƒ = 4Â°C'dir. Su sÄ±caklÄ±ÄŸÄ± 15Â°C ise skor = 1.0 (maksimum). 
                Su 23Â°C'ye Ã§Ä±karsa skor = 0.14'e dÃ¼ÅŸer (balÄ±k "ÅŸokta"). Bu sayede "BalÄ±k aktif mi?" sorusu milimetrik hesaplanÄ±r.
            </div>
            <div class="algo-reference">
                <span class="ref-icon">ğŸ“„</span>
                <div class="ref-content">
                    <div class="ref-title">"Sea Bass Population Dynamics in the Coastal Waters"</div>
                    <div class="ref-author">Sarah, Z. (2018) - Normal Distribution in Fish Populations</div>
                </div>
            </div>
        </div>

        <!-- 3. SOLUNAR TEORÄ°SÄ° -->
        <div class="algo-section solunar">
            <div class="algo-title">
                <span class="icon">ğŸŒ™</span>
                <span style="color: var(--yellow);">3. SOLUNAR TEORÄ°SÄ° ve AY FAZI</span>
            </div>
            <div class="algo-description">
                Ay, okyanusun motorudur. Dolunay ve Yeni Ay dÃ¶nemlerinde yerÃ§ekimi artar, gelgit (tide) gÃ¼Ã§lenir. 
                Hareketli su, besin zincirini tetikler ve balÄ±klarÄ± beslenmeye zorlar. Solunar Teorisi, Ay'Ä±n DÃ¼nya'ya 
                gÃ¶re konumunu hesaplayarak gÃ¼nÃ¼n "Major" (ana) ve "Minor" (tali) beslenme pencerelerini belirler.
            </div>
            <div class="algo-formula">
                Major Period = Ay Transit (tepe noktasÄ±) Â± 2 saat â†’ Ã‡arpan: Ã—1.35<br>
                Minor Period = Ay DoÄŸuÅŸ/BatÄ±ÅŸ Â± 1 saat â†’ Ã‡arpan: Ã—1.15
            </div>
            <div class="algo-example">
                <strong>Ã–rnek:</strong> BugÃ¼n Ay saat 14:30'da tepe noktasÄ±na ulaÅŸÄ±yorsa, 12:30-16:30 arasÄ± "Major Period"dur. 
                Bu saatlerde tÃ¼m balÄ±k skorlarÄ±na Ã—1.35 Ã§arpanÄ± uygulanÄ±r. Deneyimli balÄ±kÃ§Ä±lar bu saatleri "AltÄ±n Saatler" olarak bilir.
            </div>
            <div class="algo-reference">
                <span class="ref-icon">ğŸ“„</span>
                <div class="ref-content">
                    <div class="ref-title">"Solunar Theory and Sport Fishing Success Rates"</div>
                    <div class="ref-author">Knight, J.A. (1936) - Moon Up, Moon Down</div>
                </div>
            </div>
        </div>

        <!-- 4. YEREL KURALLAR -->
        <div class="algo-section local">
            <div class="algo-title">
                <span class="icon">ğŸ£</span>
                <span style="color: var(--orange);">4. YEREL KURALLAR (Saha ZekasÄ±)</span>
            </div>
            <div class="algo-description">
                Akademik makaleler laboratuvar ortamÄ±nÄ± anlatÄ±r, Meraloji ise "merayÄ±" anlatÄ±r. Sistem, akademik verileri 
                saha tecrÃ¼beleriyle (Rule-Based Overrides) ezer veya gÃ¼Ã§lendirir. Marmara'da iÅŸe yarayan taktiÄŸin Ege'de 
                Ã§alÄ±ÅŸmamasÄ±nÄ±n sebebi budur.
            </div>
            <div class="algo-formula">
                IF (BÃ¶lge = MARMARA AND RÃ¼zgar = LODOS) THEN Skor += 15<br>
                IF (BÃ¶lge = MARMARA AND RÃ¼zgar = POYRAZ) THEN Skor -= 20<br>
                IF (Dalga > 0.6m AND TÃ¼r = LEVREK) THEN "Pusu Bonusu" += 10<br>
                IF (BasÄ±nÃ§_Trendi = DÃœÅÃœYOR) THEN "Feeding Frenzy" Modu AKTÄ°F
            </div>
            <div class="algo-example">
                <strong>Ã–rnek:</strong> BasÄ±nÃ§ son 3 saatte 5 hPa dÃ¼ÅŸtÃ¼yse, fÄ±rtÄ±na yaklaÅŸÄ±yor demektir. BalÄ±klar bunu hisseder 
                ve "stok yapma" gÃ¼dÃ¼sÃ¼yle saldÄ±rganlaÅŸÄ±r. Sistem bu durumu tespit edip "Feeding Frenzy" modunu aÃ§ar ve tÃ¼m 
                avcÄ± balÄ±k skorlarÄ±na +20 bonus ekler.
            </div>
            <div class="algo-reference">
                <span class="ref-icon">ğŸ“„</span>
                <div class="ref-content">
                    <div class="ref-title">"Field Neural Network"</div>
                    <div class="ref-author">Micheal, R. et al. (2021) - Marine Ecosystem Dynamics</div>
                </div>
            </div>
        </div>

        <!-- 5. VERÄ° FÃœZYONU -->
        <div class="algo-section" style="border-left-color: #a78bfa;">
            <div class="algo-title">
                <span class="icon">ğŸ§¬</span>
                <span style="color: #a78bfa;">5. VERÄ° FÃœZYONU ve FÄ°NAL SKOR</span>
            </div>
            <div class="algo-description">
                TÃ¼m alt sistemlerden gelen skorlar aÄŸÄ±rlÄ±klÄ± ortalama ile birleÅŸtirilir. Biyolojik faktÃ¶rler (mevsim, tÃ¼r davranÄ±ÅŸÄ±) 
                %25, Ã§evresel faktÃ¶rler (sÄ±caklÄ±k, dalga, rÃ¼zgar) %50, tetikleyiciler (solunar, basÄ±nÃ§ trendi) %25 aÄŸÄ±rlÄ±ÄŸa sahiptir.
            </div>
            <div class="algo-formula">
                Final_Skor = (S_bio Ã— 0.25) + (S_env Ã— 0.50) + (S_trigger Ã— 0.25) + Noise(Ïƒ=2)<br>
                Final_Skor = clamp(Final_Skor, 15, 98) â†’ Min %15, Max %98
            </div>
            <div class="algo-example">
                <strong>GÃ¼ven AralÄ±ÄŸÄ±:</strong> BugÃ¼n iÃ§in tahmin gÃ¼veni %90'dÄ±r. Her gÃ¼n iÃ§in gÃ¼ven %5 dÃ¼ÅŸer 
                (yarÄ±n %85, 3 gÃ¼n sonra %75). Bu, meteorolojik tahminlerin doÄŸasÄ±ndan kaynaklanÄ±r.
            </div>
            <div class="algo-reference">
                <span class="ref-icon">ğŸ“„</span>
                <div class="ref-content">
                    <div class="ref-title">"Multi-Sensor Data Fusion for Marine Ecosystem Prediction"</div>
                    <div class="ref-author">Chen, X. et al. (2021) - Ocean Engineering, Vol. 234</div>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         JAVASCRIPT
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // DATA & STATE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        let GLOBAL_DATA = null;
        let CURRENT_MODE = 'daily';
        let map = null;
        let markerLayer = null;
        let lastLatLon = null;
        let currentLayerIndex = 0;

        // Harita KatmanlarÄ± - 3 aÅŸamalÄ± dÃ¶ngÃ¼
        const MAP_LAYERS = [
            {
                name: 'CoÄŸrafi',
                url: 'https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png',
                options: { maxZoom: 19 }
            },
            {
                name: 'Uydu',
                url: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
                options: { maxZoom: 18 }
            },
            {
                name: 'KaranlÄ±k',
                url: 'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',
                options: { maxZoom: 19 }
            }
        ];

        let currentTileLayer = null;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // DÄ°L SÄ°STEMÄ° - TR/EN Toggle
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        let CURRENT_LANG = 'tr';
        
        const TRANSLATIONS = {
            tr: {
                // Genel
                score: "Skor",
                daily: "GÃœN",
                instant: "ANLIK",
                confidence: "GÃ¼ven",
                land: "KARA",
                landMessage: "BurasÄ± kara parÃ§asÄ±. LÃ¼tfen denizde bir nokta seÃ§in.",
                noSeaData: "Deniz verisi bulunamadÄ±",
                selectSea: "ğŸŒŠ Denizde bir nokta seÃ§tiÄŸinizde<br>balÄ±k analizi burada gÃ¶rÃ¼necek",
                
                // Ä°lk ekran yÃ¶nlendirme
                welcomeTitle: "BALIK MERA ANALÄ°ZÄ°",
                welcomeSubtitle: "Denizde bir noktaya tÄ±klayÄ±n",
                
                // Aktivite Saatleri
                morningWater: "SABAH SUYU",
                eveningWater: "AKÅAM SUYU",
                nightHunt: "GECE AVI",
                noon: "Ã–ÄLEN",
                morningWaterTip: "Åafak Â±2 saat. AvcÄ± balÄ±klar besleniyor.",
                eveningWaterTip: "GÃ¼n batÄ±mÄ± Â±2 saat. GÃ¼nÃ¼n en verimli saatleri.",
                nightHuntTip: "22:00 - 03:00. EÅŸkina, MÄ±rmÄ±r, Ä°skorpit aktif.",
                noonTip: "11:00 - 16:00. Aktivite dÃ¼ÅŸÃ¼k.",
                
                // BalÄ±k KartÄ±
                bait: "Yem",
                lure: "Sahte",
                rig: "TakÄ±m",
                hook: "Ä°ÄŸne",
                legalSize: "Yasal Boy",
                peakTime: "En Aktif",
                note: "Not",
                species: "TÃ¼rler",
                speciesHint: "Detay iÃ§in tÄ±klayÄ±n",
                noData: "Veri bulunamadÄ±",
                
                // Metrikler
                waterTemp: "Su SÄ±caklÄ±ÄŸÄ±",
                wave: "Dalga",
                wind: "RÃ¼zgar",
                clarity: "BerraklÄ±k",
                pressure: "BasÄ±nÃ§",
                salinity: "Tuzluluk",
                moon: "Ay FazÄ±",
                tide: "Gel-Git",
                current: "AkÄ±ntÄ±",
                cloud: "Bulut",
                
                // Zaman
                time: "Saat",
                connecting: "BaÄŸlantÄ±",
                processing: "Deniz verileri iÅŸleniyor...",
                complete: "Hesaplama tamamlandÄ±.",
                
                // MenÃ¼
                menu: "MERALOJÄ°",
                favorites: "Favori MeralarÄ±m",
                noFavorites: "HenÃ¼z favori eklenmedi",
                mapLayer: "Harita KatmanÄ±",
                weeklyForecast: "7 GÃ¼nlÃ¼k Tahmin Raporu",
                addFavorite: "Favorilere Kaydet",
                algorithm: "Algoritma DokÃ¼mantasyonu",
                about: "HakkÄ±nda",
                
                // Modallar
                close: "Kapat",
                metricInfo: "Metrik Bilgisi",
                reference: "Referans DeÄŸerler",
                algorithmUsed: "KullanÄ±lan Algoritma",
                source: "Kaynak",
                importance: "Ã–nemi",
                
                // HaftalÄ±k tahmin
                weeklyTitle: "7 GÃ¼nlÃ¼k Tahmin",
                day: "GÃ¼n",
                topSpecies: "En Ä°yi TÃ¼rler",
                tactic: "Taktik",
                
                // Harita katmanlarÄ±
                geographic: "CoÄŸrafi",
                satellite: "Uydu",
                dark: "KaranlÄ±k"
            },
            en: {
                // General
                score: "Score",
                daily: "DAY",
                instant: "NOW",
                confidence: "Confidence",
                land: "LAND",
                landMessage: "This is land. Please select a point on the sea.",
                noSeaData: "No marine data available",
                selectSea: "ğŸŒŠ Select a point on the sea<br>to see fish analysis",
                
                // Welcome screen
                welcomeTitle: "FISHING SPOT ANALYSIS",
                welcomeSubtitle: "Tap on the sea to analyze",
                
                // Activity Windows
                morningWater: "MORNING BITE",
                eveningWater: "EVENING BITE",
                nightHunt: "NIGHT HUNT",
                noon: "MIDDAY",
                morningWaterTip: "Dawn Â±2 hours. Predator fish are feeding.",
                eveningWaterTip: "Sunset Â±2 hours. Most productive hours.",
                nightHuntTip: "22:00 - 03:00. Brown Meagre, Striped Bream active.",
                noonTip: "11:00 - 16:00. Low activity.",
                
                // Fish Card
                bait: "Bait",
                lure: "Lure",
                rig: "Rig",
                hook: "Hook",
                legalSize: "Legal Size",
                peakTime: "Peak Time",
                note: "Note",
                species: "Species",
                speciesHint: "Tap for details",
                noData: "No data available",
                
                // Metrics
                waterTemp: "Water Temp",
                wave: "Wave",
                wind: "Wind",
                clarity: "Clarity",
                pressure: "Pressure",
                salinity: "Salinity",
                moon: "Moon Phase",
                tide: "Tide",
                current: "Current",
                cloud: "Cloud",
                
                // Time
                time: "Time",
                connecting: "Connecting",
                processing: "Processing marine data...",
                complete: "Analysis complete.",
                
                // Menu
                menu: "MERALOJI",
                favorites: "My Favorite Spots",
                noFavorites: "No favorites added yet",
                mapLayer: "Map Layer",
                weeklyForecast: "7-Day Forecast Report",
                addFavorite: "Add to Favorites",
                algorithm: "Algorithm Documentation",
                about: "About",
                
                // Modals
                close: "Close",
                metricInfo: "Metric Info",
                reference: "Reference Values",
                algorithmUsed: "Algorithm Used",
                source: "Source",
                importance: "Importance",
                
                // Weekly forecast
                weeklyTitle: "7-Day Forecast",
                day: "Day",
                topSpecies: "Top Species",
                tactic: "Tactic",
                
                // Map layers
                geographic: "Geographic",
                satellite: "Satellite",
                dark: "Dark"
            }
        };
        
        function t(key) {
            return TRANSLATIONS[CURRENT_LANG][key] || key;
        }
        
        function toggleLanguage() {
            CURRENT_LANG = CURRENT_LANG === 'tr' ? 'en' : 'tr';
            document.getElementById('lang-btn').innerText = CURRENT_LANG.toUpperCase();
            
            // Tab'larÄ± gÃ¼ncelle
            document.getElementById('tab-daily').innerText = t('daily');
            document.getElementById('tab-instant').innerText = t('instant');
            
            // Welcome overlay gÃ¼ncelle
            const welcomeTitle = document.getElementById('welcome-title');
            const welcomeSubtitle = document.getElementById('welcome-subtitle');
            if (welcomeTitle) welcomeTitle.innerText = t('welcomeTitle');
            if (welcomeSubtitle) welcomeSubtitle.innerText = '+ ' + t('welcomeSubtitle');
            
            // Search placeholder gÃ¼ncelle
            const searchInput = document.getElementById('search-input');
            if (searchInput) searchInput.placeholder = CURRENT_LANG === 'tr' ? 'Mera ara...' : 'Search spot...';
            
            // Section title gÃ¼ncelle
            const speciesTitle = document.getElementById('species-title');
            if (speciesTitle) speciesTitle.innerText = t('species') + ' (' + t('speciesHint') + ')';
            
            // EÄŸer veri varsa paneli yeniden render et
            if (GLOBAL_DATA) {
                const targetData = CURRENT_MODE === 'daily' ? GLOBAL_DATA.forecast[0] : GLOBAL_DATA.instant;
                renderPanel(GLOBAL_DATA, targetData);
            }
        }

        // PopÃ¼ler BalÄ±kÃ§Ä±lÄ±k MeralarÄ± - AkÄ±llÄ± Arama iÃ§in
        const FISHING_SPOTS = [
            { name: "FoÃ§a", region: "Ä°zmir / Ege", lat: 38.6697, lon: 26.7572 },
            { name: "Ã‡eÅŸme", region: "Ä°zmir / Ege", lat: 38.3236, lon: 26.3029 },
            { name: "Urla", region: "Ä°zmir / Ege", lat: 38.3225, lon: 26.7645 },
            { name: "Seferihisar", region: "Ä°zmir / Ege", lat: 38.1975, lon: 26.8408 },
            { name: "Dikili", region: "Ä°zmir / Ege", lat: 39.0714, lon: 26.8886 },
            { name: "Karaburun", region: "Ä°zmir / Ege", lat: 38.6381, lon: 26.5097 },
            { name: "AyvalÄ±k", region: "BalÄ±kesir / Ege", lat: 39.3125, lon: 26.6944 },
            { name: "Cunda AdasÄ±", region: "BalÄ±kesir / Ege", lat: 39.3300, lon: 26.7100 },
            { name: "Bodrum", region: "MuÄŸla / Ege", lat: 37.0344, lon: 27.4305 },
            { name: "DatÃ§a", region: "MuÄŸla / Ege", lat: 36.7333, lon: 27.6833 },
            { name: "Marmaris", region: "MuÄŸla / Ege", lat: 36.8550, lon: 28.2744 },
            { name: "Fethiye", region: "MuÄŸla / Akdeniz", lat: 36.6514, lon: 29.1231 },
            { name: "KaÅŸ", region: "Antalya / Akdeniz", lat: 36.2000, lon: 29.6500 },
            { name: "Alanya", region: "Antalya / Akdeniz", lat: 36.5444, lon: 31.9994 },
            { name: "Side", region: "Antalya / Akdeniz", lat: 36.7675, lon: 31.3903 },
            { name: "Antalya KaleiÃ§i", region: "Antalya / Akdeniz", lat: 36.8841, lon: 30.7056 },
            { name: "BeÅŸiktaÅŸ", region: "Ä°stanbul / Marmara", lat: 41.0422, lon: 29.0053 },
            { name: "SarÄ±yer", region: "Ä°stanbul / Marmara", lat: 41.1669, lon: 29.0572 },
            { name: "Rumeli KavaÄŸÄ±", region: "Ä°stanbul / Marmara", lat: 41.1775, lon: 29.0758 },
            { name: "Anadolu KavaÄŸÄ±", region: "Ä°stanbul / Marmara", lat: 41.1794, lon: 29.0875 },
            { name: "Bebek", region: "Ä°stanbul / Marmara", lat: 41.0769, lon: 29.0431 },
            { name: "Florya", region: "Ä°stanbul / Marmara", lat: 40.9667, lon: 28.7833 },
            { name: "KadÄ±kÃ¶y", region: "Ä°stanbul / Marmara", lat: 40.9819, lon: 29.0231 },
            { name: "Adalar (BÃ¼yÃ¼kada)", region: "Ä°stanbul / Marmara", lat: 40.8686, lon: 29.1256 },
            { name: "Yalova", region: "Yalova / Marmara", lat: 40.6550, lon: 29.2756 },
            { name: "Mudanya", region: "Bursa / Marmara", lat: 40.3764, lon: 28.8828 },
            { name: "Erdek", region: "BalÄ±kesir / Marmara", lat: 40.3972, lon: 27.7917 },
            { name: "Marmara AdasÄ±", region: "BalÄ±kesir / Marmara", lat: 40.6167, lon: 27.6167 },
            { name: "BandÄ±rma", region: "BalÄ±kesir / Marmara", lat: 40.3500, lon: 27.9667 },
            { name: "Ã‡anakkale", region: "Ã‡anakkale / Marmara", lat: 40.1553, lon: 26.4142 },
            { name: "Gelibolu", region: "Ã‡anakkale / Marmara", lat: 40.4097, lon: 26.6703 },
            { name: "Sinop", region: "Sinop / Karadeniz", lat: 42.0231, lon: 35.1531 },
            { name: "Amasra", region: "BartÄ±n / Karadeniz", lat: 41.7472, lon: 32.3864 },
            { name: "Trabzon", region: "Trabzon / Karadeniz", lat: 41.0027, lon: 39.7168 },
            { name: "Rize", region: "Rize / Karadeniz", lat: 41.0201, lon: 40.5234 },
            { name: "Samsun", region: "Samsun / Karadeniz", lat: 41.2867, lon: 36.3300 },
            { name: "Giresun", region: "Giresun / Karadeniz", lat: 40.9128, lon: 38.3895 },
            { name: "AkÃ§akoca", region: "DÃ¼zce / Karadeniz", lat: 41.0833, lon: 31.1167 },
            { name: "Mersin", region: "Mersin / Akdeniz", lat: 36.8000, lon: 34.6333 },
            { name: "Ä°skenderun", region: "Hatay / Akdeniz", lat: 36.5817, lon: 36.1700 }
        ];

        // DetaylÄ± Metrik Bilgileri
        const METRIC_DATA = {
            temp: {
                icon: "ğŸŒ¡ï¸",
                title: "SU SICAKLIÄI",
                titleEn: "WATER TEMPERATURE",
                desc: "Deniz yÃ¼zeyi sÄ±caklÄ±ÄŸÄ± (Sea Surface Temperature - SST), uydu sensÃ¶rleri tarafÄ±ndan Ã¶lÃ§Ã¼len ve balÄ±k metabolizmasÄ±nÄ± doÄŸrudan etkileyen en kritik parametredir.",
                descEn: "Sea Surface Temperature (SST) measured by satellite sensors, the most critical parameter directly affecting fish metabolism.",
                importance: "BalÄ±klar soÄŸukkanlÄ± (poikilotherm) canlÄ±lardÄ±r, vÃ¼cut Ä±sÄ±larÄ±nÄ± dÃ¼zenleyemezler. Su sÄ±caklÄ±ÄŸÄ± metabolizma hÄ±zÄ±nÄ±, sindirim sÃ¼resini ve dolayÄ±sÄ±yla beslenme ihtiyacÄ±nÄ± belirler.",
                importanceEn: "Fish are cold-blooded (poikilotherm), unable to regulate body temperature. Water temperature determines metabolic rate, digestion time, and feeding requirements.",
                ref: "Ege: 18-24Â°C (Yaz)\nMarmara: 14-19Â°C\nKaradeniz: 12-18Â°C\nAkdeniz: 20-26Â°C",
                algo: "Gaussian: f(T) = exp(-(T - T_opt)Â² / 2ÏƒÂ²)\nLevrek: T_opt=15Â°C, Ïƒ=4Â°C",
                source: "FAO FishBase (2024) - Species Temperature Ranges; NOAA Coral Reef Watch SST Data"
            },
            clarity: {
                icon: "ğŸ‘ï¸",
                title: "SU BERRAKLIÄI",
                titleEn: "WATER CLARITY",
                desc: "Suyun gÃ¶rÃ¼ÅŸ mesafesi (Secchi derinliÄŸi). Dalga, rÃ¼zgar ve yaÄŸÄ±ÅŸ miktarÄ±na baÄŸlÄ± olarak dinamik deÄŸiÅŸir.",
                descEn: "Underwater visibility (Secchi depth). Dynamically changes based on wave action, wind, and rainfall.",
                importance: "AvcÄ± balÄ±klar avlarÄ±nÄ± gÃ¶rerek yakalar. Orta bulanÄ±klÄ±kta pusu kurabilirler. Ã‡ok berrak suda yemi ve misinayÄ± gÃ¶rÃ¼rler.",
                importanceEn: "Predator fish hunt by sight. They can ambush in moderate turbidity. In very clear water, they see bait and line.",
                ref: "Ä°deal: %50-%85\nLevrek: %40-%70\nKalamar: %70-%95",
                algo: "clarity = 100 - (wave Ã— 12) - (wind Ã— 0.6) - (rain Ã— 4)",
                source: "UNESCO IOC - Ocean Optics Protocols; FAO Fishing Technology Guidelines"
            },
            wind: {
                icon: "ğŸ’¨",
                title: "RÃœZGAR HIZI",
                titleEn: "WIND SPEED",
                desc: "10 metre yÃ¼kseklikteki rÃ¼zgar hÄ±zÄ± ve yÃ¶nÃ¼. Deniz yÃ¼zeyi karÄ±ÅŸÄ±mÄ±nÄ± ve plankton daÄŸÄ±lÄ±mÄ±nÄ± etkiler.",
                descEn: "Wind speed and direction at 10m height. Affects sea surface mixing and plankton distribution.",
                importance: "RÃ¼zgar suyu oksijenlendirir. Lodos balÄ±ÄŸÄ± kÄ±yÄ±ya iter, Poyraz aÃ§Ä±ÄŸa kaÃ§Ä±rÄ±r.",
                importanceEn: "Wind oxygenates water. South wind pushes fish to shore, North wind pushes them offshore.",
                ref: "0-15 km/s: Sakin\n15-25 km/s: Orta\n25-40 km/s: Sert\n40+: Tehlikeli",
                algo: "Lodos (S): +15 bonus\nPoyraz (N): -20 penalty",
                source: "NOAA National Weather Service - Marine Weather Guidelines; Knight J.A. (1936) Solunar Theory"
            },
            wave: {
                icon: "ğŸŒŠ",
                title: "DALGA YÃœKSEKLÄ°ÄÄ°",
                titleEn: "WAVE HEIGHT",
                desc: "AnlamlÄ± dalga yÃ¼ksekliÄŸi (Hs). KÃ¶pÃ¼klÃ¼ su Levrek iÃ§in ideal, sakin su Kalamar iÃ§in gerekli.",
                descEn: "Significant wave height (Hs). Foamy water ideal for Sea Bass, calm water required for Squid.",
                importance: "0.6m+ dalga kÃ¶pÃ¼klÃ¼ su yaratÄ±r. Levrek pusu kurabilir, saldÄ±rganlaÅŸÄ±r.",
                importanceEn: "Waves above 0.6m create foamy water. Sea Bass can ambush and becomes aggressive.",
                ref: "0-0.3m: Sakin\n0.6-1.2m: Levrek ideal\n2.0m+: Tehlikeli",
                algo: "Gaussian curve per species\nLevrek: ideal=0.9m",
                source: "NOAA Wave Watch III Model; ECMWF ERA5 Reanalysis"
            },
            salinity: {
                icon: "ğŸ§‚",
                title: "TUZLULUK",
                titleEn: "SALINITY",
                desc: "Deniz suyundaki tuz miktarÄ± (PSU). TÃ¼rkiye denizleri arasÄ±nda bÃ¼yÃ¼k farklar var.",
                descEn: "Salt content in seawater (PSU). Large variations between Turkish seas.",
                importance: "Tuzluluk ozmotik dengeyi etkiler. Kefal dÃ¼ÅŸÃ¼k tuzluluÄŸu sever.",
                importanceEn: "Salinity affects osmotic balance. Mullet prefers lower salinity.",
                ref: "Karadeniz: 17-18 PSU\nMarmara: 22-26 PSU\nEge/Akdeniz: 38-40 PSU",
                algo: "Regional fixed values\nRain > 10mm: -3 PSU coastal",
                source: "Copernicus Marine Service - Mediterranean Sea Salinity; World Ocean Atlas 2023"
            },
            pressure: {
                icon: "ğŸ“‰",
                title: "ATMOSFERÄ°K BASINÃ‡",
                titleEn: "BAROMETRIC PRESSURE",
                desc: "Deniz seviyesinde atmosferik basÄ±nÃ§ (hPa). Hava deÄŸiÅŸiminin en gÃ¼venilir gÃ¶stergesi.",
                descEn: "Atmospheric pressure at sea level (hPa). Most reliable indicator of weather change.",
                importance: "DÃ¼ÅŸen basÄ±nÃ§ balÄ±klarÄ± saldÄ±rganlaÅŸtÄ±rÄ±r - Feeding Frenzy! YÃ¼kselen basÄ±nÃ§ pasifleÅŸtirir.",
                importanceEn: "Falling pressure makes fish aggressive - Feeding Frenzy! Rising pressure makes them passive.",
                ref: "1013 hPa: Normal\nDÃ¼ÅŸÃ¼ÅŸ >3 hPa: Frenzy\nYÃ¼kseliÅŸ >3 hPa: Pasif",
                algo: "trend = P(now) - P(now-3h)\nFalling fast: +20 bonus",
                source: "Chen et al. (2021) - Barometric Pressure Effects on Fish Behavior, Ocean Engineering Vol. 234"
            },
            moon: {
                icon: "ğŸŒ™",
                title: "AY FAZI",
                titleEn: "MOON PHASE",
                desc: "29.5 gÃ¼nlÃ¼k ay dÃ¶ngÃ¼sÃ¼. Gelgitleri ve gece aydÄ±nlatmasÄ±nÄ± etkiler.",
                descEn: "29.5-day lunar cycle. Affects tides and nighttime illumination.",
                importance: "Yeni Ay ve Dolunay gelgit gÃ¼Ã§lÃ¼. Solunar teori: Ay konumu beslenmeyi tetikler.",
                importanceEn: "New Moon and Full Moon have strong tides. Solunar theory: Moon position triggers feeding.",
                ref: "Yeni Ay ğŸŒ‘: GÃ¼Ã§lÃ¼ gelgit\nDolunay ğŸŒ•: En gÃ¼Ã§lÃ¼\nEn iyi: Â±3 gÃ¼n",
                algo: "New Moon/Full Moon: +25-30% bonus",
                source: "Knight J.A. (1936) - Moon Up Moon Down: Solunar Theory; NOAA Tide Predictions"
            },
            tide: {
                icon: "ğŸŒŠ",
                title: "GELGÄ°T AKIÅI",
                titleEn: "TIDAL FLOW",
                desc: "Ay ve GÃ¼neÅŸ yerÃ§ekimi ile deniz seviyesi deÄŸiÅŸimi. Akdeniz'de sÄ±nÄ±rlÄ± etkili.",
                descEn: "Sea level change due to Moon and Sun gravity. Limited effect in Mediterranean.",
                importance: "Hareket eden su = Hareket eden balÄ±k. Slack tide (durgun) dÃ¶neminde aktivite dÃ¼ÅŸÃ¼k.",
                importanceEn: "Moving water = Moving fish. During slack tide, activity is low.",
                ref: "Akdeniz: 10-30 cm\nMarmara: 5-15 cm\nYÃ¼kselen: BalÄ±k kÄ±yÄ±ya",
                algo: "tide_flow = |sin(moon_altitude)| Ã— 1.5",
                source: "NOAA Tide and Current Predictions; IHO Tidal Constituent Database"
            },
            current: {
                icon: "ğŸ”„",
                title: "AKINTI HIZI",
                titleEn: "CURRENT SPEED",
                desc: "Yatay su hareketi (m/s). Pelajik balÄ±klar akÄ±ntÄ± hatlarÄ±nÄ± takip eder.",
                descEn: "Horizontal water movement (m/s). Pelagic fish follow current lines.",
                importance: "AkÄ±ntÄ± besin taÅŸÄ±r. GÃ¼Ã§lÃ¼ akÄ±ntÄ±da aÄŸÄ±r kurÅŸun gerekir.",
                importanceEn: "Current carries nutrients. Heavy weights needed in strong current.",
                ref: "0-0.2 m/s: Sakin\n0.4-0.6 m/s: GÃ¼Ã§lÃ¼\n0.6+: Surf modu",
                algo: "current = (wave Ã— 0.35) + (wind Ã— 0.018)",
                source: "Copernicus Marine Service - Mediterranean Sea Currents; HYCOM Ocean Model"
            },
            cloud: {
                icon: "â˜ï¸",
                title: "BULUTLULUK",
                titleEn: "CLOUD COVER",
                desc: "GÃ¶kyÃ¼zÃ¼nÃ¼n bulutlarla kaplÄ± yÃ¼zdesi (0-100%).",
                descEn: "Percentage of sky covered by clouds (0-100%).",
                importance: "Bulutlu hava = Cesaretli balÄ±k. GÃ¶lgeler kaybolunca balÄ±klar aÃ§Ä±ÄŸa Ã§Ä±kar.",
                importanceEn: "Cloudy weather = Bold fish. When shadows disappear, fish come out.",
                ref: "0-20%: AÃ§Ä±k\n50-80%: Ã‡ok iyi\n80-100%: Ä°deal",
                algo: "cloud > 70: +10 bonus\ncloud < 20: invisible line needed",
                source: "Open-Meteo Cloud Cover API; NOAA Satellite Cloud Products"
            }
        };

        const DAYS_TR = ['Pazar', 'Pazartesi', 'SalÄ±', 'Ã‡arÅŸamba', 'PerÅŸembe', 'Cuma', 'Cumartesi'];
        const DAYS_EN = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // INITIALIZATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        document.addEventListener('DOMContentLoaded', () => {
            initMap();
            initSearch();
            loadFavorites();

            // Splash timeout
            setTimeout(() => {
                document.getElementById('splash').classList.add('hidden');
                document.getElementById('controls').classList.add('visible');
            }, 2500);
        });

        function initMap() {
            try {
                map = L.map('map', {
                    zoomControl: false,
                    attributionControl: false
                }).setView([38.4237, 27.1428], 10);

                // Ä°lk katman: CoÄŸrafi
                currentTileLayer = L.tileLayer(MAP_LAYERS[0].url, MAP_LAYERS[0].options).addTo(map);
                updateMapLayerIndicator();

                map.on('click', handleMapClick);
            } catch (e) {
                console.error("Map init error:", e);
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // HARÄ°TA KATMANI DEÄÄ°ÅTÄ°RME
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function changeMapLayer() {
            // Mevcut katmanÄ± kaldÄ±r
            if (currentTileLayer) {
                map.removeLayer(currentTileLayer);
            }

            // Sonraki katmana geÃ§ (dÃ¶ngÃ¼sel)
            currentLayerIndex = (currentLayerIndex + 1) % MAP_LAYERS.length;

            // Yeni katmanÄ± ekle
            const layer = MAP_LAYERS[currentLayerIndex];
            currentTileLayer = L.tileLayer(layer.url, layer.options).addTo(map);

            updateMapLayerIndicator();
            toggleMenu();
        }

        function updateMapLayerIndicator() {
            const indicator = document.getElementById('map-layer-name');
            if (indicator) {
                indicator.textContent = `(${MAP_LAYERS[currentLayerIndex].name})`;
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // AKILLI ARAMA (Autocomplete)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function initSearch() {
            const input = document.getElementById('search-input');
            const suggestions = document.getElementById('search-suggestions');

            input.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase().trim();
                
                if (query.length < 2) {
                    suggestions.classList.remove('active');
                    return;
                }

                const filtered = FISHING_SPOTS.filter(spot => 
                    spot.name.toLowerCase().includes(query) ||
                    spot.region.toLowerCase().includes(query)
                ).slice(0, 6);

                if (filtered.length === 0) {
                    suggestions.classList.remove('active');
                    return;
                }

                suggestions.innerHTML = filtered.map((spot, i) => `
                    <div class="suggestion-item" onclick="selectSpot(${i}, '${query}')">
                        <div class="name">ğŸ“ ${highlightMatch(spot.name, query)}</div>
                        <div class="region">${spot.region}</div>
                    </div>
                `).join('');

                // FiltrelenmiÅŸ sonuÃ§larÄ± geÃ§ici sakla
                suggestions.dataset.results = JSON.stringify(filtered);
                suggestions.classList.add('active');
            });

            // DÄ±ÅŸarÄ± tÄ±klayÄ±nca kapat
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.search-wrapper')) {
                    suggestions.classList.remove('active');
                }
            });

            // Enter tuÅŸu ile ilk sonucu seÃ§
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    const firstItem = suggestions.querySelector('.suggestion-item');
                    if (firstItem) firstItem.click();
                }
            });
        }

        function highlightMatch(text, query) {
            const regex = new RegExp(`(${query})`, 'gi');
            return text.replace(regex, '<span style="color: var(--cyan); font-weight: 700;">$1</span>');
        }

        function selectSpot(index, query) {
            const suggestions = document.getElementById('search-suggestions');
            const results = JSON.parse(suggestions.dataset.results || '[]');
            const spot = results[index];

            if (spot) {
                document.getElementById('search-input').value = spot.name;
                suggestions.classList.remove('active');
                
                // Haritada konuma git ve tÄ±klama simÃ¼le et
                map.flyTo([spot.lat, spot.lon], 13, { duration: 1 });
                
                // KÄ±sa gecikme ile tÄ±klama simÃ¼le et
                setTimeout(() => {
                    handleMapClick({ latlng: { lat: spot.lat, lng: spot.lon } });
                }, 1200);
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MAP CLICK HANDLER
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function handleMapClick(e) {
            const lat = e.latlng.lat.toFixed(4);
            const lon = e.latlng.lng.toFixed(4);
            lastLatLon = { lat, lon };

            // Welcome overlay'i gizle
            const welcomeOverlay = document.getElementById('map-welcome');
            if (welcomeOverlay) welcomeOverlay.classList.add('hidden');

            // Remove old marker
            if (markerLayer) map.removeLayer(markerLayer);

            // Add new marker
            markerLayer = L.marker([lat, lon], {
                icon: L.divIcon({
                    className: 'radar-marker',
                    iconSize: [28, 28],
                    iconAnchor: [14, 14]
                })
            }).addTo(map);

            // Show loading
            closeHud();
            showLoading();

            try {
                const res = await fetch(`/api/forecast?lat=${lat}&lon=${lon}`);
                const data = await res.json();
                GLOBAL_DATA = data;
                runLoadingAnimation(data);
            } catch (err) {
                hideLoading();
                alert("BaÄŸlantÄ± hatasÄ±: " + err.message);
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // LOADING ANIMATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function showLoading() {
            document.getElementById('loading').style.display = 'flex';
            document.getElementById('log-output').innerHTML = '';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        function runLoadingAnimation(data) {
            const logOutput = document.getElementById('log-output');
            
            // TÄ±klama saatini frontend'de hesapla (gerÃ§ek kullanÄ±cÄ± saati)
            const now = new Date();
            const userHour = now.getHours();
            const userMinute = now.getMinutes().toString().padStart(2, '0');
            
            const steps = [
                { text: `ğŸ“¡ ${t('connecting')}: <span>${data.region}</span>`, delay: 0 },
                { text: `â±ï¸ ${t('time')}: <span>${userHour}:${userMinute}</span>`, delay: 400 },
                { text: `ğŸŒŠ ${t('processing')}`, delay: 900 },
                { text: `ğŸ£ ${t('complete')}`, delay: 1500 }
            ];

            steps.forEach((step, i) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = 'log-line';
                    div.innerHTML = `> ${step.text}`;
                    div.style.animationDelay = `${i * 0.1}s`;
                    logOutput.appendChild(div);
                }, step.delay);
            });

            setTimeout(() => {
                hideLoading();
                setMode('daily');
                document.getElementById('hud').style.display = 'flex';
            }, 1800);
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MODE SWITCHING
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function setMode(mode) {
            if (!GLOBAL_DATA) return;
            CURRENT_MODE = mode;

            // Update tabs
            document.getElementById('tab-daily').className = mode === 'daily' ? 'mode-tab active' : 'mode-tab';
            document.getElementById('tab-instant').className = mode === 'instant' ? 'mode-tab active' : 'mode-tab';

            const targetData = mode === 'daily' ? GLOBAL_DATA.forecast[0] : GLOBAL_DATA.instant;
            renderPanel(GLOBAL_DATA, targetData);
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // RENDER PANEL
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function renderPanel(global, data) {
            document.getElementById('region-title').innerText = global.region;

            if (global.isLand) {
                document.getElementById('score-display').innerHTML = `<span style="font-size: 1.2rem;">ğŸ”ï¸ ${t('land')}</span>`;
                document.getElementById('score-display').style.color = 'var(--red)';
                document.getElementById('weather-display').innerText = "";
                document.getElementById('tactic-display').innerText = t('landMessage');
                document.getElementById('metrics-grid').innerHTML = `<div style="grid-column: 1/-1; text-align: center; padding: 20px; color: var(--text-muted);">${t('noSeaData')}</div>`;
                document.getElementById('fish-list').innerHTML = `<div style="text-align: center; padding: 30px; color: var(--text-muted);">${t('selectSea')}</div>`;
                document.getElementById('confidence-display').innerText = '';
                document.getElementById('activity-windows').style.display = 'none';
                return;
            }

            // Score
            const score = data.score || 0;
            document.getElementById('score-display').innerHTML = `<sup>%</sup>${score.toFixed(1)}`;
            document.getElementById('score-display').style.color = getScoreColor(score);
            
            // Weather
            document.getElementById('weather-display').innerText = data.weatherSummary || '';
            
            // Tactic
            document.getElementById('tactic-display').innerText = data.tactic || '';

            // Confidence
            const conf = CURRENT_MODE === 'daily' ? (global.forecast[0]?.confidence || 90) : 95;
            document.getElementById('confidence-display').innerText = `${t('confidence')}: %${conf}`;

            // Aktivite Saatleri (sadece gÃ¼nlÃ¼k modda gÃ¶ster)
            const activityCard = document.getElementById('activity-windows');
            if (CURRENT_MODE === 'daily' && global.forecast[0]?.activityWindows) {
                const aw = global.forecast[0].activityWindows;
                activityCard.style.display = 'block';
                
                // Etiketleri gÃ¼ncelle
                document.getElementById('activity-morning-label').innerText = t('morningWater');
                document.getElementById('activity-evening-label').innerText = t('eveningWater');
                document.getElementById('activity-night-label').innerText = t('nightHunt');
                
                // Saatleri gÃ¼ncelle
                document.getElementById('activity-morning-time').innerText = `${aw.morning.start} - ${aw.morning.end}`;
                document.getElementById('activity-evening-time').innerText = `${aw.evening.start} - ${aw.evening.end}`;
                document.getElementById('activity-night-time').innerText = `${aw.night.start} - ${aw.night.end}`;
            } else {
                activityCard.style.display = 'none';
            }

            // Metrics
            renderMetrics(global, data);

            // Fish List
            renderFishList(data.fishList, 'fish-list');
        }

        // Aktivite Tooltip gÃ¶sterimi
        function showActivityTip(type) {
            // Ã–nceki tooltip'i kaldÄ±r
            const existing = document.querySelector('.activity-tooltip');
            if (existing) existing.remove();
            
            const tips = {
                morning: t('morningWaterTip'),
                evening: t('eveningWaterTip'),
                night: t('nightHuntTip')
            };
            
            const tooltip = document.createElement('div');
            tooltip.className = 'activity-tooltip';
            tooltip.innerText = tips[type];
            
            // Pozisyonlama
            const row = event.currentTarget;
            const rect = row.getBoundingClientRect();
            tooltip.style.left = `${rect.left + rect.width / 2 - 140}px`;
            tooltip.style.top = `${rect.top - 60}px`;
            
            document.body.appendChild(tooltip);
            
            // 3 saniye sonra kaldÄ±r
            setTimeout(() => tooltip.remove(), 3000);
            
            // DÄ±ÅŸarÄ± tÄ±klayÄ±nca kaldÄ±r
            setTimeout(() => {
                document.addEventListener('click', function handler(e) {
                    if (!tooltip.contains(e.target)) {
                        tooltip.remove();
                        document.removeEventListener('click', handler);
                    }
                });
            }, 100);
        }

        function renderMetrics(global, data) {
            const daily = global.forecast[0];
            const grid = document.getElementById('metrics-grid');
            
            const metrics = [
                { key: 'temp', val: data.temp || daily.temp, unit: 'Â°' },
                { key: 'wind', val: data.wind || daily.wind, unit: ' km' },
                { key: 'clarity', val: data.clarity || daily.clarity, unit: '%' },
                { key: 'wave', val: daily.wave, unit: 'm' },
                { key: 'salinity', val: daily.salinity, unit: ' P' },
                { key: 'pressure', val: data.pressure || daily.pressure, unit: '' },
                { key: 'moon', val: '', unit: '' },
                { key: 'tide', val: daily.tide, unit: 'm' },
                { key: 'current', val: daily.current, unit: '' },
                { key: 'cloud', val: daily.cloud, unit: '' }
            ];

            grid.innerHTML = metrics.map(m => {
                const metricInfo = METRIC_DATA[m.key];
                const icon = metricInfo?.icon || 'ğŸ“Š';
                let val = typeof m.val === 'number' ? m.val.toFixed(0) : m.val;
                
                // Ay fazÄ± iÃ§in Ã¶zel gÃ¶sterim
                if (m.key === 'moon') {
                    val = getMoonPhaseShort(daily.moonPhase);
                }

                return `
                    <div class="metric-card" onclick="showMetricInfo('${m.key}')">
                        <div class="metric-icon">${icon}</div>
                        <div class="metric-val">${val}${m.unit}</div>
                        <div class="metric-label">${metricInfo?.title?.split(' ')[0] || m.key}</div>
                    </div>
                `;
            }).join('');
        }

        function getMoonPhaseShort(phase) {
            if (phase < 0.125) return "ğŸŒ‘";
            if (phase < 0.25) return "ğŸŒ’";
            if (phase < 0.375) return "ğŸŒ“";
            if (phase < 0.5) return "ğŸŒ”";
            if (phase < 0.625) return "ğŸŒ•";
            if (phase < 0.75) return "ğŸŒ–";
            if (phase < 0.875) return "ğŸŒ—";
            return "ğŸŒ˜";
        }

        function renderFishList(list, containerId) {
            const container = document.getElementById(containerId);
            if (!list || list.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-muted); padding: 20px;">Veri bulunamadÄ±</div>';
                return;
            }

            container.innerHTML = list.map(f => {
                const scoreClass = f.score >= 70 ? 'score-high' : (f.score >= 50 ? 'score-mid' : 'score-low');
                const reasonClass = f.score >= 50 ? 'positive' : 'negative';
                const reasonIcon = f.score >= 50 ? 'âœ…' : 'âš ï¸';
                
                // Dile gÃ¶re isim seÃ§
                const displayName = CURRENT_LANG === 'en' ? (f.nameEn || f.name) : f.name;
                const scientificLine = CURRENT_LANG === 'en' && f.scientificName 
                    ? `<div style="font-size: 0.7rem; color: var(--text-muted); font-style: italic; margin-top: 2px;">${f.scientificName}</div>` 
                    : '';
                
                // Aktif saat gÃ¶sterimi
                const peakTimeLabel = t('peakTime');
                const peakTimeLine = f.peakHoursDesc 
                    ? `<div style="margin-top: 6px; padding-top: 6px; border-top: 1px solid var(--border-subtle);">ğŸ• <strong>${peakTimeLabel}:</strong> ${f.peakHoursDesc}</div>` 
                    : '';

                return `
                    <div class="fish-item ${scoreClass}" onclick="this.classList.toggle('open')">
                        <div class="fish-header">
                            <div class="fish-name">
                                ${f.icon} ${displayName}
                                ${scientificLine}
                            </div>
                            <div class="fish-score" style="color: ${getScoreColor(f.score)}">%${f.score.toFixed(1)}</div>
                        </div>
                        <div class="fish-details">
                            ${f.reason ? `<div class="fish-reason ${reasonClass}">${reasonIcon} ${f.reason}</div>` : ''}
                            <div>ğŸ¯ <strong>${t('bait')}:</strong> ${f.bait}</div>
                            <div>ğŸ£ <strong>${t('hook')}:</strong> ${f.method}</div>
                            ${f.lure ? `<div>ğŸª <strong>${t('lure')}:</strong> ${f.lure}</div>` : ''}
                            ${f.rig ? `<div>âš™ï¸ <strong>${t('rig')}:</strong> ${f.rig}</div>` : ''}
                            ${f.legalSize ? `<div>ğŸ“ <strong>${t('legalSize')}:</strong> ${f.legalSize}</div>` : ''}
                            ${peakTimeLine}
                            ${f.note ? `<div class="fish-tip">ğŸ’¡ ${f.note}</div>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // UTILITY FUNCTIONS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function getScoreColor(score) {
            if (score >= 70) return 'var(--green)';
            if (score >= 50) return 'var(--yellow)';
            return 'var(--red)';
        }

        function formatDate(dateStr) {
            const d = new Date(dateStr);
            const days = CURRENT_LANG === 'en' ? DAYS_EN : DAYS_TR;
            return `${days[d.getDay()]}, ${d.getDate()}/${d.getMonth() + 1}`;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MODALS & UI ACTIONS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function closeHud() {
            document.getElementById('hud').style.display = 'none';
        }

        function toggleMenu() {
            const menu = document.getElementById('side-menu');
            const overlay = document.getElementById('menu-overlay');
            menu.classList.toggle('active');
            overlay.style.display = menu.classList.contains('active') ? 'block' : 'none';
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        function showMetricInfo(key) {
            const data = METRIC_DATA[key];
            if (!data) return;

            // Dile gÃ¶re metin seÃ§
            const title = CURRENT_LANG === 'en' && data.titleEn ? data.titleEn : data.title;
            const desc = CURRENT_LANG === 'en' && data.descEn ? data.descEn : data.desc;
            const importance = CURRENT_LANG === 'en' && data.importanceEn ? data.importanceEn : data.importance;

            document.getElementById('metric-icon').innerText = data.icon;
            document.getElementById('metric-title').innerText = title;
            document.getElementById('metric-desc').innerText = desc;
            document.getElementById('metric-importance').innerText = importance;
            document.getElementById('metric-ref').innerHTML = data.ref.replace(/\n/g, '<br>');
            document.getElementById('metric-algo').innerHTML = data.algo.replace(/\n/g, '<br>');
            document.getElementById('metric-source').innerText = data.source;
            document.getElementById('metric-modal').style.display = 'flex';
        }

        function showWeeklyModal() {
            if (!GLOBAL_DATA || !GLOBAL_DATA.forecast) return;

            const content = document.getElementById('weekly-content');
            content.innerHTML = GLOBAL_DATA.forecast.map((day, i) => `
                <div class="day-row" onclick="showDayDetail(${i})">
                    <div class="day-info">
                        <div class="day-date">${formatDate(day.date)}</div>
                        <div class="day-weather">${day.weatherSummary}</div>
                    </div>
                    <div class="day-score" style="color: ${getScoreColor(day.score)}">%${day.score.toFixed(1)}</div>
                </div>
            `).join('');

            document.getElementById('weekly-modal').style.display = 'flex';
        }

        function showDayDetail(index) {
            const day = GLOBAL_DATA.forecast[index];
            if (!day) return;

            document.getElementById('dd-date').innerText = formatDate(day.date);
            document.getElementById('dd-score').innerHTML = `<sup>%</sup>${day.score.toFixed(1)}`;
            document.getElementById('dd-score').style.color = getScoreColor(day.score);
            document.getElementById('dd-weather').innerText = day.weatherSummary;
            document.getElementById('dd-tactic').innerText = day.tactic;

            renderFishList(day.fishList, 'dd-fish-list');
            
            closeModal('weekly-modal');
            document.getElementById('day-modal').style.display = 'flex';
        }

        function showTechModal() {
            toggleMenu();
            document.getElementById('tech-modal').style.display = 'flex';
        }

        function locateMe() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    pos => map.flyTo([pos.coords.latitude, pos.coords.longitude], 14),
                    () => alert("Konum alÄ±namadÄ±.")
                );
            }
        }

        function saveFavorite() {
            if (!lastLatLon) return;
            const name = prompt("Mera adÄ±:");
            if (name) {
                const favs = JSON.parse(localStorage.getItem('meraloji_favs') || '[]');
                favs.push({ name, ...lastLatLon });
                localStorage.setItem('meraloji_favs', JSON.stringify(favs));
                loadFavorites();
                alert("Kaydedildi!");
            }
        }

        function loadFavorites() {
            const favs = JSON.parse(localStorage.getItem('meraloji_favs') || '[]');
            const container = document.getElementById('fav-list');
            
            if (favs.length === 0) {
                container.innerHTML = '<div style="color: var(--text-muted); font-size: 0.85rem;">HenÃ¼z kayÄ±t yok</div>';
                return;
            }

            container.innerHTML = favs.map((f, i) => `
                <button class="menu-btn" onclick="goToFavorite(${i})">ğŸ“ ${f.name}</button>
            `).join('');
        }

        function goToFavorite(index) {
            const favs = JSON.parse(localStorage.getItem('meraloji_favs') || '[]');
            const fav = favs[index];
            if (fav) {
                toggleMenu();
                map.flyTo([fav.lat, fav.lon], 14);
                setTimeout(() => {
                    handleMapClick({ latlng: { lat: parseFloat(fav.lat), lng: parseFloat(fav.lon) } });
                }, 1000);
            }
        }
    </script>
</body>
</html>
